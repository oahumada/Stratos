import{d as K,_ as L,r as m,p as Q,o as R,b as n,c as W,e as X,f as a,w as l,j as Z,k as u,G as x,t as z,J as ee,K as ae,m as te}from"./app-BQBzBluS.js";import{u as le}from"./useApi-DEBD0yG7.js";import"./apiHelper-CL77IM7H.js";const oe={class:"scenario-selector"},se=K({layout:L,__name:"ScenarioSelector",setup(ne){const v=le(),{showSuccess:f,showError:y}=ee(),w=m([]),g=m(!1),d=m(!1),p=m(null),i=m({name:"",description:"",scenario_type:"growth",horizon_months:12,fiscal_year:new Date().getFullYear()}),r=m({status:null,fiscalYear:null}),Y=["draft","active","completed","archived"],F=[{value:"growth",title:"Crecimiento"},{value:"transformation",title:"Transformación"},{value:"optimization",title:"Optimización"},{value:"crisis",title:"Crisis"},{value:"custom",title:"Personalizado"}],A=Q(()=>{const t=new Date().getFullYear();return Array.from({length:5},(e,s)=>t+s)}),U=[{title:"Name",key:"name"},{title:"Status",key:"status"},{title:"Fiscal Year",key:"fiscal_year"},{title:"Horizon (months)",key:"horizon_months"},{title:"Created",key:"created_at"},{title:"Actions",key:"actions",sortable:!1}],$=t=>({draft:"warning",active:"success",completed:"info",archived:"grey"})[t]||"default",_=async()=>{g.value=!0;try{const t={};r.value.status&&(t.status=r.value.status),r.value.fiscalYear&&(t.fiscal_year=r.value.fiscalYear);const e=await v.get("/api/strategic-planning/scenarios",{params:t});w.value=Array.isArray(e.data)?e.data:Array.isArray(e)?e:[]}catch{y("Failed to load scenarios")}finally{g.value=!1}},C=()=>{_()},D=(t,e)=>{const s=e?.item||t;s&&s.id?ae.visit(`/strategic-planning/${s.id}`):console.error("Invalid scenario selected:",s)},N=t=>{p.value=t,i.value={name:t.name,description:t.description,scenario_type:t.scenario_type||"growth",horizon_months:t.horizon_months,fiscal_year:t.fiscal_year},d.value=!0},h=async()=>{try{p.value?(await v.put(`/api/strategic-planning/scenarios/${p.value.id}`,i.value),f("Scenario updated successfully")):(await v.post("/api/strategic-planning/scenarios",i.value),f("Scenario created successfully")),d.value=!1,p.value=null,_()}catch(t){console.error("Save scenario error:",t);const e=t?.response?.data?.message,s=t?.response?.data?.errors,c=s?Object.values(s).flat()[0]:null;y(e||c||t?.message||"Failed to save scenario")}},E=async t=>{if(confirm("Are you sure you want to delete this scenario?"))try{await v.delete(`/api/strategic-planning/scenarios/${t}`),f("Scenario deleted successfully"),_()}catch{y("Failed to delete scenario")}};return R(()=>{_()}),(t,e)=>{const s=n("v-col"),c=n("v-btn"),b=n("v-row"),V=n("v-select"),M=n("v-chip"),k=n("v-icon"),q=n("v-data-table"),O=n("v-card-title"),S=n("v-text-field"),T=n("v-textarea"),B=n("v-card-text"),H=n("v-spacer"),P=n("v-card-actions"),j=n("v-card"),I=n("v-dialog"),G=n("v-container");return X(),W("div",oe,[a(G,{fluid:""},{default:l(()=>[a(b,{class:"mb-4"},{default:l(()=>[a(s,{cols:"12",md:"6"},{default:l(()=>[...e[10]||(e[10]=[Z("h2",null,"Planning Scenarios",-1)])]),_:1}),a(s,{cols:"12",md:"6",class:"text-right"},{default:l(()=>[a(c,{color:"primary",onClick:e[0]||(e[0]=o=>d.value=!0),"prepend-icon":"mdi-plus"},{default:l(()=>[...e[11]||(e[11]=[u(" New Scenario ",-1)])]),_:1})]),_:1})]),_:1}),a(b,{class:"mb-4"},{default:l(()=>[a(s,{cols:"12",md:"4"},{default:l(()=>[a(V,{modelValue:r.value.status,"onUpdate:modelValue":[e[1]||(e[1]=o=>r.value.status=o),C],items:Y,label:"Filter by Status",clearable:""},null,8,["modelValue"])]),_:1}),a(s,{cols:"12",md:"4"},{default:l(()=>[a(V,{modelValue:r.value.fiscalYear,"onUpdate:modelValue":[e[2]||(e[2]=o=>r.value.fiscalYear=o),C],items:A.value,label:"Fiscal Year",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1}),a(q,{headers:U,items:w.value,loading:g.value,"items-per-page":10,class:"elevation-1","onClick:row":D},{"item.status":l(({item:o})=>[a(M,{color:$(o.status),"text-color":"white",size:"small"},{default:l(()=>[u(z(o.status),1)]),_:2},1032,["color"])]),"item.actions":l(({item:o})=>[a(c,{icon:"",size:"small",onClick:x(J=>N(o),["stop"]),title:"Edit"},{default:l(()=>[a(k,null,{default:l(()=>[...e[12]||(e[12]=[u("mdi-pencil",-1)])]),_:1})]),_:1},8,["onClick"]),a(c,{icon:"",size:"small",onClick:x(J=>E(o.id),["stop"]),title:"Delete",color:"error"},{default:l(()=>[a(k,null,{default:l(()=>[...e[13]||(e[13]=[u("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:1},8,["items","loading"]),a(I,{modelValue:d.value,"onUpdate:modelValue":e[9]||(e[9]=o=>d.value=o),"max-width":"600px"},{default:l(()=>[a(j,null,{default:l(()=>[a(O,null,{default:l(()=>[u(z(p.value?"Edit Scenario":"Create Scenario"),1)]),_:1}),a(B,null,{default:l(()=>[a(S,{modelValue:i.value.name,"onUpdate:modelValue":e[3]||(e[3]=o=>i.value.name=o),label:"Scenario Name",required:"",class:"mb-3"},null,8,["modelValue"]),a(T,{modelValue:i.value.description,"onUpdate:modelValue":e[4]||(e[4]=o=>i.value.description=o),label:"Description",rows:"3",class:"mb-3"},null,8,["modelValue"]),a(V,{modelValue:i.value.scenario_type,"onUpdate:modelValue":e[5]||(e[5]=o=>i.value.scenario_type=o),items:F,label:"Tipo de Escenario",required:"",class:"mb-3"},null,8,["modelValue"]),a(b,null,{default:l(()=>[a(s,{cols:"12",md:"6"},{default:l(()=>[a(S,{modelValue:i.value.horizon_months,"onUpdate:modelValue":e[6]||(e[6]=o=>i.value.horizon_months=o),modelModifiers:{number:!0},label:"Planning Horizon (months)",type:"number",min:"1",max:"36",required:""},null,8,["modelValue"])]),_:1}),a(s,{cols:"12",md:"6"},{default:l(()=>[a(S,{modelValue:i.value.fiscal_year,"onUpdate:modelValue":e[7]||(e[7]=o=>i.value.fiscal_year=o),modelModifiers:{number:!0},label:"Fiscal Year",type:"number",required:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(P,null,{default:l(()=>[a(H),a(c,{onClick:e[8]||(e[8]=o=>d.value=!1)},{default:l(()=>[...e[14]||(e[14]=[u("Cancel",-1)])]),_:1}),a(c,{color:"primary",onClick:h},{default:l(()=>[...e[15]||(e[15]=[u("Save",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}}),ue=te(se,[["__scopeId","data-v-fc43aa78"]]);export{ue as default};
