import{Q as f,l as s,d as v,r as c,b as p,c as u,e as l,w as r,g as o,t as g,i as _,O as A,j as b,m as S}from"./app-B4Q7DtOZ.js";function n(e){if(!e)return e;if(typeof e=="string")try{const t=JSON.parse(e);return n(t)}catch{return{content:e}}if(e&&typeof e=="object"&&typeof e.content=="string")try{const t=JSON.parse(e.content);return n(t)}catch{return{...e,content:e.content}}if(e.escenario){const t=e.escenario,a={};return a.scenario_metadata={name:t.nombre||t.id||null,generated_at:t.fecha_actualizacion||t.generated_at||null,confidence_score:t.confidence_score||t.confidence||null,raw_escenario:t},a.capabilities=Array.isArray(t.capabilities)?t.capabilities:[],a.competencies=Array.isArray(t.competencies)?t.competencies:[],a.skills=Array.isArray(t.skills)?t.skills:[],a.suggested_roles=Array.isArray(t.suggested_roles)?t.suggested_roles:[],a.impact_analysis=Array.isArray(t.impact_analysis)?t.impact_analysis:[],a.confidence_score=a.scenario_metadata.confidence_score,a}if(e.choices&&Array.isArray(e.choices)&&e.choices.length){const t=[];for(const i of e.choices)i.delta&&typeof i.delta=="object"?t.push(Object.values(i.delta).join("")):i.message&&typeof i.message=="object"?typeof i.message.content=="string"&&t.push(i.message.content):typeof i.text=="string"&&t.push(i.text);const a=t.join("");try{const i=JSON.parse(a);return n(i)}catch{return{content:a}}}return e.confidence_score||(e.confidence_score=e.confidence||e.confidenceScore||e.confidence_percent||null),e.scenario_metadata&&e.scenario_metadata.generated_at&&(e.scenario_metadata.generated_at=String(e.scenario_metadata.generated_at)),Array.isArray(e.capabilities)||(e.capabilities=e.capabilities||[]),Array.isArray(e.competencies)||(e.competencies=e.competencies||[]),Array.isArray(e.skills)||(e.skills=e.skills||[]),Array.isArray(e.suggested_roles)||(e.suggested_roles=e.suggested_roles||[]),Array.isArray(e.impact_analysis)||(e.impact_analysis=e.impact_analysis||[]),e.scenario_metadata||e.capabilities||e.content?(e.confidence_score||(e.confidence_score=e.scenario_metadata?.confidence_score??null),e):{content:e}}const j=f("scenarioGeneration",{state:()=>({step:1,data:{company_name:"",industry:"",sub_industry:"",company_size:0,geographic_scope:"",organizational_cycle:"",current_challenges:"",current_capabilities:"",current_gaps:"",current_roles_count:0,has_formal_competency_model:!1,auto_generate:!1,strategic_goal:"",target_markets:"",expected_growth:"",transformation_type:[],key_initiatives:"",budget_level:"",talent_availability:"",training_capacity:"",technology_maturity:"",critical_constraints:"",time_horizon:"",urgency_level:"",milestones:"",organization_id:null,instruction_language:"es"},generating:!1,generationId:null,generationStatus:null,generationProgress:null,recentChunks:[],generationResult:null,previewPrompt:null,importAfterAccept:!1,importAutoAccepted:!1}),actions:{next(){this.step=Math.min(5,this.step+1)},setField(e,t){Object.prototype.hasOwnProperty.call(this.data,e)?this.data[e]=t:this.data[e]=t},prev(){this.step=Math.max(1,this.step-1)},reset(){this.step=1,this.generationId=null,this.generationStatus=null,this.generationResult=null},prefillDemo(){this.data.company_name="Acme Labs S.A.",this.data.industry="Tecnología / Software",this.data.sub_industry="Plataformas de datos e IA",this.data.company_size=450,this.data.geographic_scope="LatAm",this.data.organizational_cycle="Anual",this.data.current_challenges="Baja adopción de modelos de IA, falta de datos etiquetados y equipos con experiencia limitada en ML.",this.data.current_capabilities="Equipos de data engineering básicos, pipelines de datos internos y experiencia en integración de APIs.",this.data.current_gaps="Carencia de modelos generativos productivos, no hay prácticas MLOps maduras.",this.data.current_roles_count=120,this.data.has_formal_competency_model=!1,this.data.strategic_goal="Adoptar IA generativa para mejorar productividad y automatizar tareas de atención al cliente y documentación técnica.",this.data.target_markets="Mercado latinoamericano; clientes enterprise y pymes tecnológicas",this.data.expected_growth="Aumento del 25% en eficiencia operativa en 12 meses",this.data.transformation_type=["automation","innovation"],this.data.key_initiatives="Pilotos de chatbots generativos, generación automática de documentación, integración con soporte y herramientas internas.",this.data.budget_level="Medio",this.data.talent_availability="Limitada internamente; se requiere contratación y formación.",this.data.training_capacity="Moderada; equipo de L&D con programas trimestrales.",this.data.technology_maturity="Madurez media: infra de datos existente pero falta orquestación y modelos.",this.data.critical_constraints="Regulación de datos y privacidad, riesgo de calidad de respuestas generadas.",this.data.time_horizon="12 meses",this.data.urgency_level="Alta",this.data.milestones="1) Piloto interno (3 meses); 2) Integración con soporte (6 meses); 3) Escalado productivo (12 meses)"},async generate(){this.generating=!0;try{const e=await s.post("/api/strategic-planning/scenarios/generate",this.preparePayload());return this.generationId=e.data.data.id,this.generationStatus=e.data.data.status,this.importAutoAccepted=!1,e.data}catch(e){throw e}finally{this.generating=!1}},async preview(){try{const e=await s.post("/api/strategic-planning/scenarios/generate/preview",this.preparePayload());return this.previewPrompt=e.data.data.prompt,this.previewPrompt}catch(e){throw e}},preparePayload(){const e={...this.data};if(e.geographic_scope!==void 0&&e.geographic_scope!==null&&(e.geographic_scope=String(e.geographic_scope)),e.organizational_cycle!==void 0&&e.organizational_cycle!==null&&(e.organizational_cycle=String(e.organizational_cycle)),e.organization_id!==void 0&&e.organization_id!==null&&e.organization_id!==""){const t=Number(e.organization_id);Number.isNaN(t)?delete e.organization_id:e.organization_id=Math.trunc(t)}else delete e.organization_id;if(e.instruction_id!==void 0&&e.instruction_id!==null&&e.instruction_id!==""){const t=Number(e.instruction_id);Number.isNaN(t)?delete e.instruction_id:e.instruction_id=Math.trunc(t)}else delete e.instruction_id;return e.instruction!==void 0&&(e.instruction===null||e.instruction==="")&&delete e.instruction,e},async fetchStatus(){if(!this.generationId)return;const e=await s.get(`/api/strategic-planning/scenarios/generate/${this.generationId}`);this.generationStatus=e.data.data.status;const t=e.data.data.llm_response;if(t==null&&e.data.data.metadata&&e.data.data.metadata.compacted)try{const a=await s.get(`/api/strategic-planning/scenarios/generate/${this.generationId}/compacted`);if(a.data&&a.data.success){const i=a.data.data;this.generationResult=n(i)}else this.generationResult=n(t)}catch{this.generationResult=n(t)}else this.generationResult=n(t);try{console.debug("[scenarioGenerationStore] fetchStatus -> generationStatus=",this.generationStatus,"generationResult=",JSON.parse(JSON.stringify(this.generationResult||null)))}catch(a){console.debug("[scenarioGenerationStore] fetchStatus log error",a)}if(this.generationStatus==="complete"&&this.importAfterAccept&&!this.importAutoAccepted)try{await this.accept(this.generationId),this.importAutoAccepted=!0}catch(a){console.error("Auto-accept failed",a)}return e.data},async accept(e){const t=e||this.generationId;if(!t)throw new Error("No generation id provided");try{return(await s.post(`/api/strategic-planning/scenarios/generate/${t}/accept`,{import:!!this.importAfterAccept})).data}catch(a){throw a}},async fetchProgress(){if(!this.generationId)return null;try{const e=await s.get(`/api/strategic-planning/scenarios/generate/${this.generationId}/progress`);if(e.data&&e.data.success&&e.data.data){const t=e.data.data;return this.generationProgress=t.progress??this.generationProgress,this.recentChunks=t.recent_chunks??[],t}}catch{}return null},validate(){const e=this.data,t=[];return["company_name","industry","company_size","current_challenges","current_capabilities","strategic_goal","key_initiatives","time_horizon"].forEach(i=>{if(!e[i]){const d={company_name:"Nombre de la organización",industry:"Industria",company_size:"Tamaño (personas)",current_challenges:"Desafíos",current_capabilities:"Capacidades existentes",strategic_goal:"Objetivo principal",key_initiatives:"Iniciativas clave",time_horizon:"Plazo"};t.push(d[i]||i)}}),{valid:t.length===0,errors:t}}}}),x={class:"help-title"},z={key:0,class:"help-desc"},N={key:1,class:"help-example"},I={style:{background:"#f5f5f7",padding:"8px","border-radius":"4px",margin:"6px 0","white-space":"pre-wrap"}},P=v({__name:"FieldHelp",props:{title:{type:String,required:!0},description:{type:String,required:!1},example:{type:String,required:!1}},setup(e){return(t,a)=>{const i=c("v-icon"),d=c("v-card-text"),m=c("v-card"),h=c("v-menu");return p(),u("div",null,[l(h,{"offset-y":""},{activator:r(({props:y})=>[l(i,A(y,{small:"",class:"ml-2 cursor-pointer"}),{default:r(()=>[...a[0]||(a[0]=[b("mdi-information-outline",-1)])]),_:1},16)]),default:r(()=>[l(m,{style:{"max-width":"320px"}},{default:r(()=>[l(d,null,{default:r(()=>[o("div",x,[o("strong",null,g(e.title),1)]),e.description?(p(),u("div",z,g(e.description),1)):_("",!0),e.example?(p(),u("div",N,[a[1]||(a[1]=o("div",{style:{"margin-top":"8px"}},[o("em",null,"Ejemplo:")],-1)),o("pre",I,g(e.example),1)])):_("",!0)]),_:1})]),_:1})]),_:1})])}}}),M=S(P,[["__scopeId","data-v-62ce1c77"]]);export{M as F,n,j as u};
