import{u as et}from"./useApi-D-wG6FEk.js";import{d as at,_ as lt,o as ot,r as n,b as u,f as p,w as a,e,g as l,j as s,c as G,F as N,q as P,t as r,i as T,k as g,J as nt,m as st}from"./app-B4Q7DtOZ.js";import"./apiHelper-BLoNXDsG.js";const it={class:"text-h4 font-weight-bold"},rt={class:"d-flex justify-space-between align-start"},dt={class:"text-overline"},ut={class:"text-h6"},ct={class:"my-2 text-body-2"},vt={class:"d-flex justify-space-between align-center"},_t={class:"text-caption"},pt={class:"text-overline font-weight-bold text-primary"},mt={class:"text-h3"},ft={class:"text-caption"},gt={class:"text-caption"},yt={class:"d-flex align-center mt-4"},xt={class:"text-h2"},bt={class:"d-flex align-center mt-4"},wt={class:"text-h2"},kt=at({layout:lt,__name:"ScenarioStrategyAssigner",props:{scenarioId:{}},setup(q){const S=q,C=et(),{showSuccess:F,showError:$}=nt(),c=g(1),m=g(!1),R=g([]),y=g(null),V=g(null),d=g({gap_id:"",strategy_type:"build",rationale:"",appointed_owner_id:1,budget_allocation:0}),M=async()=>{m.value=!0;try{const i=await C.get(`/api/strategic-planning/scenarios/${S.scenarioId}/gaps-for-assignment`);R.value=i.data}catch(i){$("Error al cargar gaps: "+i.message)}finally{m.value=!1}},O=i=>{V.value=i,d.value.gap_id=i.id,d.value.rationale=`Se recomienda estrategia basada en ${i.recommended_strategy}`,c.value=2},D=async()=>{m.value=!0;try{await C.post("/api/strategic-planning/strategies/assign",d.value),F("Estrategia asignada con éxito"),await U(),c.value=3}catch(i){$("Error al asignar estrategia: "+i.message)}finally{m.value=!1}},U=async()=>{try{const i=await C.get(`/api/strategic-planning/strategies/portfolio/${S.scenarioId}`);y.value=i.data}catch(i){console.error(i)}};ot(()=>{M(),U()});const L=i=>i==="critical"?"error":"warning";return(i,t)=>{const J=n("v-icon"),v=n("v-col"),f=n("v-row"),B=n("v-stepper-item"),w=n("v-divider"),W=n("v-stepper-header"),E=n("v-card-title"),Y=n("v-progress-circular"),H=n("v-chip"),x=n("v-btn"),_=n("v-card"),b=n("v-card-text"),A=n("v-stepper-window-item"),k=n("v-radio"),K=n("v-radio-group"),Q=n("v-textarea"),X=n("v-text-field"),j=n("v-spacer"),z=n("v-card-actions"),Z=n("v-stepper-window"),h=n("v-stepper"),tt=n("v-container");return u(),p(tt,null,{default:a(()=>[e(f,{class:"mb-4"},{default:a(()=>[e(v,{cols:"12"},{default:a(()=>[l("h2",it,[e(J,{size:"large",color:"primary",class:"mr-2"},{default:a(()=>[...t[6]||(t[6]=[s("mdi-target-variant",-1)])]),_:1}),t[7]||(t[7]=s(" Asignador de Estrategias de Talento (4B) ",-1))]),t[8]||(t[8]=l("p",{class:"text-subtitle-1 text-medium-emphasis"}," Transforma los gaps detectados en iniciativas estratégicas: Build, Buy, Borrow o Bot. ",-1))]),_:1})]),_:1}),e(h,{modelValue:c.value,"onUpdate:modelValue":t[5]||(t[5]=o=>c.value=o),class:"elevation-2 rounded-lg"},{default:a(()=>[e(W,null,{default:a(()=>[e(B,{complete:c.value>1,title:"Identificar Gaps",value:"1"},null,8,["complete"]),e(w),e(B,{complete:c.value>2,title:"Asignar Estrategia",value:"2"},null,8,["complete"]),e(w),e(B,{title:"Revisar Portafolio",value:"3"})]),_:1}),e(Z,null,{default:a(()=>[e(A,{value:"1"},{default:a(()=>[e(_,{variant:"flat"},{default:a(()=>[e(E,null,{default:a(()=>[...t[9]||(t[9]=[s("Brechas de Capacidad Identificadas",-1)])]),_:1}),e(b,null,{default:a(()=>[m.value?(u(),p(f,{key:0,justify:"center",class:"pa-12"},{default:a(()=>[e(Y,{indeterminate:"",color:"primary"})]),_:1})):(u(),p(f,{key:1},{default:a(()=>[(u(!0),G(N,null,P(R.value,o=>(u(),p(v,{key:o.id,cols:"12",md:"6"},{default:a(()=>[e(_,{border:"",flat:"",class:"pa-3 hover-card"},{default:a(()=>[l("div",rt,[l("div",null,[l("div",dt,r(o.capability),1),l("div",ut,r(o.role_archetype),1)]),e(H,{color:L(o.criticality),size:"small",class:"text-uppercase"},{default:a(()=>[s(r(o.criticality),1)]),_:2},1032,["color"])]),l("div",ct,r(o.description),1),e(w,{class:"my-2"}),l("div",vt,[l("span",_t,[t[10]||(t[10]=s("Requerimiento: ",-1)),l("strong",null,r(o.talent_requirement_count),1),t[11]||(t[11]=s(" talentos",-1))]),e(x,{color:"primary",variant:"tonal",size:"small",onClick:I=>O(o)},{default:a(()=>[...t[12]||(t[12]=[s(" Configurar Estrategia ",-1)])]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(A,{value:"2"},{default:a(()=>[V.value?(u(),p(_,{key:0,variant:"flat"},{default:a(()=>[e(E,null,{default:a(()=>[s("Configurar Estrategia para "+r(V.value.role_archetype),1)]),_:1}),e(b,null,{default:a(()=>[e(f,null,{default:a(()=>[e(v,{cols:"12",md:"6"},{default:a(()=>[e(K,{modelValue:d.value.strategy_type,"onUpdate:modelValue":t[0]||(t[0]=o=>d.value.strategy_type=o),label:"Seleccionar Modalidad 4B"},{default:a(()=>[e(k,{value:"build"},{label:a(()=>[...t[13]||(t[13]=[l("div",null,[l("strong",null,"BUILD"),s(" (Upskilling / Desarrollo Interno)")],-1)])]),_:1}),e(k,{value:"buy"},{label:a(()=>[...t[14]||(t[14]=[l("div",null,[l("strong",null,"BUY"),s(" (Reclutamiento de Expertos)")],-1)])]),_:1}),e(k,{value:"borrow"},{label:a(()=>[...t[15]||(t[15]=[l("div",null,[l("strong",null,"BORROW"),s(" (Contingent Talent / Consultoría)")],-1)])]),_:1}),e(k,{value:"bot"},{label:a(()=>[...t[16]||(t[16]=[l("div",null,[l("strong",null,"BOT"),s(" (Automatización / IA / Agentes)")],-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"6"},{default:a(()=>[e(Q,{modelValue:d.value.rationale,"onUpdate:modelValue":t[1]||(t[1]=o=>d.value.rationale=o),label:"Justificación Estratégica",rows:"4",variant:"outlined",placeholder:"Explica por qué esta es la mejor opción para la viabilidad del escenario..."},null,8,["modelValue"]),e(X,{modelValue:d.value.budget_allocation,"onUpdate:modelValue":t[2]||(t[2]=o=>d.value.budget_allocation=o),modelModifiers:{number:!0},label:"Presupuesto Asignado",type:"number",prefix:"$",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(z,null,{default:a(()=>[e(j),e(x,{variant:"text",onClick:t[3]||(t[3]=o=>c.value=1)},{default:a(()=>[...t[17]||(t[17]=[s("Volver",-1)])]),_:1}),e(x,{color:"primary",loading:m.value,onClick:D},{default:a(()=>[...t[18]||(t[18]=[s("Confirmar Estrategia",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})):T("",!0)]),_:1}),e(A,{value:"3"},{default:a(()=>[y.value?(u(),p(_,{key:0,variant:"flat"},{default:a(()=>[e(E,null,{default:a(()=>[...t[19]||(t[19]=[s("Portafolio de Iniciativas Consolidado",-1)])]),_:1}),e(b,null,{default:a(()=>[e(f,null,{default:a(()=>[(u(!0),G(N,null,P(y.value.portfolio,(o,I)=>(u(),p(v,{key:I,cols:"12",md:"3"},{default:a(()=>[e(_,{class:"pa-4 text-center border"},{default:a(()=>[l("div",pt,r(I),1),l("div",mt,r(o.count),1),l("div",ft,r(o.status),1),e(w,{class:"my-2"}),l("div",gt,[t[20]||(t[20]=s("Inv: ",-1)),l("strong",null,"$"+r(o.investment.toLocaleString()),1)])]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(f,{class:"mt-8"},{default:a(()=>[e(v,{cols:"12",md:"6"},{default:a(()=>[e(_,{color:"teal-darken-3",theme:"dark"},{default:a(()=>[e(b,null,{default:a(()=>[t[22]||(t[22]=l("div",{class:"text-h6"},"Impacto en Viabilidad",-1)),l("div",yt,[l("div",xt,r(y.value.summary_metrics.capability_coverage_delta),1),t[21]||(t[21]=l("div",{class:"ml-4"},"Aumento proyectado en cobertura de capacidades clave.",-1))])]),_:1})]),_:1})]),_:1}),e(v,{cols:"12",md:"6"},{default:a(()=>[e(_,{color:"indigo-darken-3",theme:"dark"},{default:a(()=>[e(b,null,{default:a(()=>[t[24]||(t[24]=l("div",{class:"text-h6"},"Reducción de Riesgo",-1)),l("div",bt,[l("div",wt,r(Math.round(y.value.summary_metrics.risk_reduction_index*100))+"%",1),t[23]||(t[23]=l("div",{class:"ml-4"},"Índice de mitigación de brechas críticas.",-1))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(z,null,{default:a(()=>[e(x,{color:"primary",variant:"outlined",pill:"",onClick:t[4]||(t[4]=o=>c.value=1)},{default:a(()=>[...t[25]||(t[25]=[s("Asignar Otro Gap",-1)])]),_:1}),e(j),e(x,{color:"success","prepend-icon":"mdi-check-all"},{default:a(()=>[...t[26]||(t[26]=[s("Finalizar Plan Estratégico",-1)])]),_:1})]),_:1})]),_:1})):T("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Et=st(kt,[["__scopeId","data-v-7458da01"]]);export{Et as default};
