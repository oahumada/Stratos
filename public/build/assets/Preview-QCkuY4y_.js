import{d as S,r as s,b as d,f as m,w as e,e as t,g as r,t as c,j as u,v as $,m as N,s as D,i as w,k as f,o as G,c as K,F as O,q as U,_ as J,K as E}from"./app-B4Q7DtOZ.js";const Q={class:"text-h2 font-weight-bold"},W=S({__name:"SynthetizationIndexCard",props:{suggestedRoles:{}},setup(l){const _=l,y=$(()=>!_.suggestedRoles||_.suggestedRoles.length===0?0:_.suggestedRoles.reduce((a,p)=>a+(p.talent_composition?.synthetic_percentage||0),0)/_.suggestedRoles.length),i=$(()=>Math.round(y.value));return(v,a)=>{const p=s("v-progress-circular"),x=s("v-card-text"),h=s("v-card");return d(),m(h,{color:"primary",variant:"tonal"},{default:e(()=>[t(x,{class:"text-center"},{default:e(()=>[a[0]||(a[0]=r("div",{class:"text-overline"},"Índice de Sintetización",-1)),r("div",Q,c(i.value)+"%",1),a[1]||(a[1]=r("div",{class:"text-caption mt-2"},"Potencial de apalancamiento IA",-1)),t(p,{"model-value":i.value,size:80,width:8,color:"primary",class:"mt-4"},{default:e(()=>[u(c(i.value)+"% ",1)]),_:1},8,["model-value"])]),_:1})]),_:1})}}}),X=N(W,[["__scopeId","data-v-7d06767d"]]),Y={class:"d-flex justify-space-between align-center mb-2"},Z={class:"text-h6"},ee={class:"text-caption text-medium-emphasis mb-4"},te={class:"mb-2"},oe={class:"d-flex justify-space-between text-caption mb-1"},ae=S({__name:"TalentCompositionCard",props:{role:{}},setup(l){const _=l,y=$(()=>{const v=_.role.talent_composition.strategy_suggestion||"";return{Buy:"success",Build:"info",Borrow:"warning",Synthetic:"secondary",Hybrid:"primary"}[v]||"grey"}),i=$(()=>`strategy-${y.value}`);return(v,a)=>{const p=s("v-chip"),x=s("v-icon"),h=s("v-progress-linear"),k=s("v-alert"),C=s("v-card-text"),R=s("v-card");return d(),m(R,{variant:"outlined",class:"mb-4"},{default:e(()=>[t(C,null,{default:e(()=>[r("div",Y,[r("div",Z,c(l.role.name),1),t(p,{color:y.value,class:D(["text-uppercase font-weight-bold",i.value]),size:"small",label:""},{default:e(()=>[u(c(l.role.talent_composition.strategy_suggestion),1)]),_:1},8,["color","class"])]),r("div",ee," FTE: "+c(l.role.estimated_fte)+" | Agente: "+c(l.role.suggested_agent_type||"N/A"),1),r("div",te,[r("div",oe,[r("span",null,[t(x,{size:"14",color:"primary"},{default:e(()=>[...a[0]||(a[0]=[u("mdi-account",-1)])]),_:1}),u(" Humano ("+c(l.role.talent_composition.human_percentage)+"%) ",1)]),r("span",null,[u(" IA ("+c(l.role.talent_composition.synthetic_percentage)+"%) ",1),t(x,{size:"14",color:"secondary"},{default:e(()=>[...a[1]||(a[1]=[u("mdi-robot",-1)])]),_:1})])]),t(h,{height:"12",rounded:"","model-value":l.role.talent_composition.human_percentage,color:"primary","background-color":"secondary","background-opacity":"1"},null,8,["model-value"])]),l.role.talent_composition.logic_justification?(d(),m(k,{key:0,density:"compact",type:"info",variant:"tonal",class:"text-caption mt-3"},{default:e(()=>[u(c(l.role.talent_composition.logic_justification),1)]),_:1})):w("",!0)]),_:1})]),_:1})}}}),ne=N(ae,[["__scopeId","data-v-aac4c849"]]),se={class:"text-h4 mb-4"},le={class:"d-flex align-center"},re={class:"flex-grow-1"},ce={class:"text-h4"},ue=S({__name:"Preview",props:{scenario:{}},setup(l){const _=l,y=f(!1),i=f(null),v=f(null),a=f(_.scenario.suggested_roles||[]),p=f(!1),x=f(null),h=f(null),k=f("error"),C=f(null);function R(o,n,g,b="error"){x.value=o,h.value=n,C.value=g??null,k.value=b,p.value=!0}async function z(){try{const o=await fetch(`/api/strategic-planning/scenarios/generate/${_.scenario.id}/compacted`,{method:"GET",headers:{Accept:"application/json"}});if(o.ok){const n=await o.json();n?.suggested_roles&&(a.value=n.suggested_roles)}else throw new Error(`status:${o.status}`)}catch(o){console.warn("failed to load compacted generation",o),i.value="No se pudieron cargar las roles sugeridos. Intenta nuevamente.",R("Error cargando roles sugeridos","Reintentar","retryLoad")}}G(()=>{(!a.value||a.value.length===0)&&z()});function I(o){return{role_name:o.name,total_fte_required:o.estimated_fte,human_leverage:o.talent_composition?.human_percentage,synthetic_leverage:o.talent_composition?.synthetic_percentage,recommended_strategy:o.talent_composition?.strategy_suggestion,agent_specs:o.suggested_agent_type??null}}const T=async()=>{y.value=!0;const o={blueprints:a.value.map(I)};E.post(`/api/strategic-planning/scenarios/generate/${_.scenario.id}/accept`,o,{onSuccess:()=>{v.value="Escenario aceptado. Redirigiendo a Paso 2...",setTimeout(()=>{E.visit(`/scenarios/${_.scenario.id}/step2`)},300)},onError:n=>{console.error("accept error",n),i.value="No se pudo aceptar el escenario. Verifica e intenta de nuevo.",R("No se pudo aceptar el escenario","Reintentar","retryAccept")},onFinish:()=>{y.value=!1,setTimeout(()=>{i.value=null,v.value=null},6e3)}})};function M(){const o=C.value;p.value=!1,o==="retryLoad"?(i.value=null,z()):o==="retryAccept"&&(i.value=null,T())}return(o,n)=>{const g=s("v-col"),b=s("v-row"),V=s("v-alert"),j=s("v-icon"),B=s("v-btn"),F=s("v-snackbar"),L=s("v-card-text"),P=s("v-card"),q=s("v-container");return d(),m(J,{title:"Preview de Escenario"},{default:e(()=>[t(q,null,{default:e(()=>[t(b,null,{default:e(()=>[t(g,{cols:"12"},{default:e(()=>[r("h1",se,c(l.scenario.scenario_metadata.name),1)]),_:1})]),_:1}),i.value||v.value?(d(),m(b,{key:0,class:"mb-4"},{default:e(()=>[t(g,{cols:"12"},{default:e(()=>[i.value?(d(),m(V,{key:0,type:"error",variant:"tonal",dense:""},{default:e(()=>[u(c(i.value),1)]),_:1})):v.value?(d(),m(V,{key:1,type:"success",variant:"tonal",dense:""},{default:e(()=>[u(c(v.value),1)]),_:1})):w("",!0)]),_:1})]),_:1})):w("",!0),t(F,{modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=A=>p.value=A),timeout:8e3,color:k.value,"multi-line":""},{default:e(()=>[r("div",le,[k.value==="error"?(d(),m(j,{key:0,class:"mr-2"},{default:e(()=>[...n[1]||(n[1]=[u("mdi-alert-circle",-1)])]),_:1})):k.value==="success"?(d(),m(j,{key:1,class:"mr-2"},{default:e(()=>[...n[2]||(n[2]=[u("mdi-check-circle",-1)])]),_:1})):w("",!0),r("div",re,c(x.value),1),h.value?(d(),m(B,{key:2,text:"",onClick:M},{default:e(()=>[u(c(h.value),1)]),_:1})):w("",!0)])]),_:1},8,["modelValue","color"]),t(b,null,{default:e(()=>[t(g,{cols:"12",md:"4"},{default:e(()=>[t(X,{suggestedRoles:a.value},null,8,["suggestedRoles"])]),_:1}),t(g,{cols:"12",md:"8"},{default:e(()=>[t(P,null,{default:e(()=>[t(L,null,{default:e(()=>[n[3]||(n[3]=r("div",{class:"text-overline"}," Confianza del Modelo ",-1)),r("div",ce,c((l.scenario.confidence_score*100).toFixed(0))+"% ",1)]),_:1})]),_:1})]),_:1})]),_:1}),t(b,{class:"mt-4"},{default:e(()=>[t(g,{cols:"12"},{default:e(()=>[...n[4]||(n[4]=[r("h2",{class:"text-h5 mb-3"},"Roles Sugeridos",-1)])]),_:1}),(d(!0),K(O,null,U(a.value,(A,H)=>(d(),m(g,{key:H,cols:"12",md:"6"},{default:e(()=>[t(ne,{role:A},null,8,["role"])]),_:2},1024))),128))]),_:1}),t(b,{class:"mt-6"},{default:e(()=>[t(g,null,{default:e(()=>[t(B,{color:"primary",size:"large",loading:y.value,onClick:T},{default:e(()=>[...n[5]||(n[5]=[u(" Aceptar y Orquestar ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})}}});export{ue as default};
