import{u as fe}from"./useApi-DEBD0yG7.js";import{d as ge,r as M,p as k,o as xe,b as s,c as x,e as c,f as t,g as m,i as w,w as e,k as n,t as i,u as f,O as we,j as r,F as C,s as F,v as he,J as ye,m as be}from"./app-BQBzBluS.js";import{u as ke}from"./scenarioPlanningScenariosStore-DvAo8lLm.js";import"./apiHelper-CL77IM7H.js";const Ce={class:"role-forecasts-table"},Fe={class:"d-flex align-center"},Ve={class:"d-flex align-center"},Ee={class:"text-body2",style:{"min-width":"50px"}},ze={class:"d-flex flex-wrap gap-2"},Se={class:"d-flex flex-wrap gap-2"},Ae={class:"text-h6"},je={class:"text-h6"},Me={class:"text-h6"},Re={class:"mb-4"},Te=ge({__name:"RoleForecastsTable",props:{scenarioId:{}},setup(I){const V=I;fe();const{showSuccess:h,showError:P}=ye(),_=ke(),d=M(null),g=M(!1),G=M(24),B=["Engineering","Product","Sales","Operations","Finance","HR","Marketing"],O=[{title:"Critical",value:"critical"},{title:"High",value:"high"},{title:"Medium",value:"medium"},{title:"Low",value:"low"}],L=[{title:"Role",value:"role_name",width:"200px"},{title:"Current FTE",value:"current_headcount",align:"center"},{title:"Projected FTE",value:"projected_headcount",align:"center"},{title:"Growth Rate",value:"growth_rate",align:"center"},{title:"Critical Skills",value:"critical_skills"},{title:"Emerging Skills",value:"emerging_skills"},{title:"Criticality",value:"criticality_level",align:"center"},{title:"Actions",value:"actions",align:"center",sortable:!1}],R=k(()=>_.getLoadingState("forecasts")),E=k(()=>_.getError("forecasts")),N=k(()=>{const o=_.getForecasts(V.scenarioId);return Array.isArray(o)?o:[]}),q=k(()=>{const o=_.getFilteredForecasts(V.scenarioId);return Array.isArray(o)?o:[]}),J=async()=>{await _.fetchForecasts(V.scenarioId)},K=async o=>{P("Actualización de forecasts aún no disponible en esta vista")},Q=o=>{d.value=o,g.value=!0},W=o=>{h(`View skill gaps for ${o.role_name}`)},X=o=>{h(`View internal matching for ${o.role_name}`)},Y=async()=>{d.value&&(await K(d.value),h("Changes saved successfully"),g.value=!1)},Z=()=>{h("Forecast report downloaded")},T=o=>o.projected_headcount-o.current_headcount,ee=o=>{const l=T(o);return l>0?"text-success":l<0?"text-error":"text-warning"},te=o=>o>=10?"primary":o>=5?"info":"warning",le=o=>o>20?"success":o>10?"info":o>=0?"warning":"error",ae=o=>({critical:"error",high:"warning",medium:"info",low:"success"})[o]||"default",oe=o=>o.includes("Engineer")?"mdi-hammer-wrench":o.includes("Manager")?"mdi-account-tie":o.includes("Analyst")?"mdi-chart-bar":o.includes("Designer")?"mdi-palette":"mdi-briefcase";return xe(()=>{J()}),N.value,(o,l)=>{const z=s("v-icon"),H=s("v-card-title"),se=s("v-card-subtitle"),y=s("v-divider"),U=s("v-select"),p=s("v-col"),b=s("v-btn"),S=s("v-row"),$=s("v-card-text"),v=s("v-chip"),ne=s("v-text-field"),re=s("v-progress-linear"),A=s("v-list-item-title"),j=s("v-list-item"),ie=s("v-list"),ce=s("v-menu"),de=s("v-data-table"),D=s("v-card"),ue=s("v-spacer"),_e=s("v-card-actions"),me=s("v-dialog"),ve=s("v-skeleton-loader"),pe=s("v-alert");return c(),x("div",Ce,[t(D,{class:"mb-4"},{default:e(()=>[t(H,{class:"d-flex align-center"},{default:e(()=>[t(z,{left:""},{default:e(()=>[...l[5]||(l[5]=[n("mdi-chart-line",-1)])]),_:1}),l[6]||(l[6]=n(" Role Forecasts ",-1))]),_:1}),t(se,null,{default:e(()=>[n(" Projected workforce needs by role over "+i(G.value)+" months ",1)]),_:1}),t(y),t($,{class:"pb-0"},{default:e(()=>[t(S,{class:"mb-4"},{default:e(()=>[t(p,{cols:"12",md:"4"},{default:e(()=>[t(U,{modelValue:f(_).filters.forecastArea,"onUpdate:modelValue":[l[0]||(l[0]=a=>f(_).filters.forecastArea=a),f(_).setForecastAreaFilter],items:B,label:"Filter by Area",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(p,{cols:"12",md:"4"},{default:e(()=>[t(U,{modelValue:f(_).filters.forecastCriticality,"onUpdate:modelValue":[l[1]||(l[1]=a=>f(_).filters.forecastCriticality=a),f(_).setForecastCriticalityFilter],items:O,label:"Filter by Criticality",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(p,{cols:"12",md:"4",class:"text-right"},{default:e(()=>[t(b,{onClick:Z,variant:"outlined",size:"small","prepend-icon":"mdi-download"},{default:e(()=>[...l[7]||(l[7]=[n(" Export ",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),t(de,{headers:L,items:q.value,loading:R.value,"items-per-page":15,class:"elevation-0",density:"comfortable"},{"item.role_name":e(({item:a})=>[r("div",Fe,[t(z,{size:"small",class:"mr-2"},{default:e(()=>[n(i(oe(a.role_name)),1)]),_:2},1024),r("strong",null,i(a.role_name),1)])]),"item.current_headcount":e(({item:a})=>[t(v,{color:te(a.current_headcount),"text-color":"white",size:"small"},{default:e(()=>[n(i(a.current_headcount)+" FTE ",1)]),_:2},1032,["color"])]),"item.projected_headcount":e(({item:a})=>[t(ne,{modelValue:a.projected_headcount,"onUpdate:modelValue":u=>a.projected_headcount=u,modelModifiers:{number:!0},type:"number",size:"small",variant:"outlined",density:"compact",disabled:"",hint:"Edición disponible próximamente","persistent-hint":"",class:"max-width-100"},null,8,["modelValue","onUpdate:modelValue"])]),"item.growth_rate":e(({item:a})=>[r("div",Ve,[t(re,{value:a.growth_rate,color:le(a.growth_rate),class:"mr-2 flex-grow-1"},null,8,["value","color"]),r("span",Ee,i(a.growth_rate)+"% ",1)])]),"item.critical_skills":e(({item:a})=>[r("div",ze,[(c(!0),x(C,null,F((a.critical_skills||[]).slice(0,2),u=>(c(),m(v,{key:u,size:"small",variant:"outlined",color:"error"},{default:e(()=>[n(i(u),1)]),_:2},1024))),128)),(a.critical_skills||[]).length>2?(c(),m(v,{key:0,size:"small",variant:"text"},{default:e(()=>[n(" +"+i((a.critical_skills||[]).length-2),1)]),_:2},1024)):w("",!0)])]),"item.emerging_skills":e(({item:a})=>[r("div",Se,[(c(!0),x(C,null,F((a.emerging_skills||[]).slice(0,2),u=>(c(),m(v,{key:u,size:"small",variant:"outlined",color:"warning"},{default:e(()=>[n(i(u),1)]),_:2},1024))),128)),(a.emerging_skills||[]).length>2?(c(),m(v,{key:0,size:"small",variant:"text"},{default:e(()=>[n(" +"+i((a.emerging_skills||[]).length-2),1)]),_:2},1024)):w("",!0)])]),"item.criticality_level":e(({item:a})=>[t(v,{color:ae(a.criticality_level),"text-color":"white",size:"small"},{default:e(()=>[n(i(a.criticality_level),1)]),_:2},1032,["color"])]),"item.actions":e(({item:a})=>[t(ce,null,{activator:e(({props:u})=>[t(b,we({icon:"",size:"small"},u),{default:e(()=>[t(z,null,{default:e(()=>[...l[8]||(l[8]=[n("mdi-dots-vertical",-1)])]),_:1})]),_:1},16)]),default:e(()=>[t(ie,null,{default:e(()=>[t(j,{onClick:u=>Q(a)},{default:e(()=>[t(A,null,{default:e(()=>[...l[9]||(l[9]=[n("View Details",-1)])]),_:1})]),_:1},8,["onClick"]),t(j,{onClick:u=>W(a)},{default:e(()=>[t(A,null,{default:e(()=>[...l[10]||(l[10]=[n("View Skill Gaps",-1)])]),_:1})]),_:1},8,["onClick"]),t(j,{onClick:u=>X(a)},{default:e(()=>[t(A,null,{default:e(()=>[...l[11]||(l[11]=[n("View Matching",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["items","loading"])]),_:1}),t(me,{modelValue:g.value,"onUpdate:modelValue":l[3]||(l[3]=a=>g.value=a),"max-width":"700px"},{default:e(()=>[d.value?(c(),m(D,{key:0},{default:e(()=>[t(H,null,{default:e(()=>[n(i(d.value.role_name)+" - Forecast Details",1)]),_:1}),t(y),t($,{class:"pt-4"},{default:e(()=>[t(S,{class:"mb-4"},{default:e(()=>[t(p,{cols:"12",md:"6"},{default:e(()=>[l[12]||(l[12]=r("div",{class:"text-caption text-medium-emphasis"}," Current Headcount ",-1)),r("div",Ae,i(d.value.current_headcount)+" FTE ",1)]),_:1}),t(p,{cols:"12",md:"6"},{default:e(()=>[l[13]||(l[13]=r("div",{class:"text-caption text-medium-emphasis"}," Projected Headcount ",-1)),r("div",je,i(d.value.projected_headcount)+" FTE ",1)]),_:1})]),_:1}),t(S,{class:"mb-4"},{default:e(()=>[t(p,{cols:"12",md:"6"},{default:e(()=>[l[14]||(l[14]=r("div",{class:"text-caption text-medium-emphasis"}," Growth Rate ",-1)),r("div",Me,i(d.value.growth_rate)+"% ",1)]),_:1}),t(p,{cols:"12",md:"6"},{default:e(()=>[l[15]||(l[15]=r("div",{class:"text-caption text-medium-emphasis"}," Change in FTE ",-1)),r("div",{class:he(["text-h6",ee(d.value)])},i(T(d.value))+" FTE ",3)]),_:1})]),_:1}),t(y,{class:"my-4"}),l[16]||(l[16]=r("h4",{class:"mb-3"},"Critical Skills Required",-1)),r("div",Re,[(c(!0),x(C,null,F(d.value.critical_skills||[],a=>(c(),m(v,{key:a,class:"mr-2 mb-2",color:"error","text-color":"white",size:"small"},{default:e(()=>[n(i(a),1)]),_:2},1024))),128))]),l[17]||(l[17]=r("h4",{class:"mb-3"},"Emerging Skills",-1)),r("div",null,[(c(!0),x(C,null,F(d.value.emerging_skills||[],a=>(c(),m(v,{key:a,class:"mr-2 mb-2",color:"warning","text-color":"white",size:"small"},{default:e(()=>[n(i(a),1)]),_:2},1024))),128))])]),_:1}),t(y),t(_e,null,{default:e(()=>[t(ue),t(b,{onClick:l[2]||(l[2]=a=>g.value=!1),variant:"text"},{default:e(()=>[...l[18]||(l[18]=[n("Close",-1)])]),_:1}),t(b,{onClick:Y,color:"primary",variant:"elevated"},{default:e(()=>[...l[19]||(l[19]=[n("Save Changes",-1)])]),_:1})]),_:1})]),_:1})):w("",!0)]),_:1},8,["modelValue"]),R.value?(c(),m(ve,{key:0,type:"table-tbody"})):w("",!0),E.value?(c(),m(pe,{key:1,type:"error",text:E.value,closable:"","onClick:close":l[4]||(l[4]=a=>E.value=null)},null,8,["text"])):w("",!0)])}}}),Ie=be(Te,[["__scopeId","data-v-0adfd9b9"]]);export{Ie as default};
