import{d as R,r as L,p as S,o as P,B as X,c as w,e as k,f as T,I as Y,F as V,s as j,w as J,i as K,q as D,j as d,t as A,T as O,v as G,m as Q}from"./app-BQBzBluS.js";import{c as W,q as U,j as E,s as Z,l as q,m as tt,a as et}from"./transform-9n3FYwas.js";import{_ as at}from"./CapabilityNode.vue_vue_type_script_setup_true_lang-5q-N-13Q.js";function st(n){return n.x+n.vx}function nt(n){return n.y+n.vy}function it(n){var u,f,C,r=1,h=1;typeof n!="function"&&(n=W(n==null?1:+n));function s(){for(var t,o=u.length,m,l,_,b,N,F,M=0;M<h;++M)for(m=U(u,st,nt).visitAfter(B),t=0;t<o;++t)l=u[t],N=f[l.index],F=N*N,_=l.x+l.vx,b=l.y+l.vy,m.visit(I);function I(e,i,a,z,H){var y=e.data,$=e.r,c=N+$;if(y){if(y.index>l.index){var g=_-y.x-y.vx,x=b-y.y-y.vy,v=g*g+x*x;v<c*c&&(g===0&&(g=E(C),v+=g*g),x===0&&(x=E(C),v+=x*x),v=(c-(v=Math.sqrt(v)))/v*r,l.vx+=(g*=v)*(c=($*=$)/(F+$)),l.vy+=(x*=v)*c,y.vx-=g*(c=1-c),y.vy-=x*c)}return}return i>_+c||z<_-c||a>b+c||H<b-c}}function B(t){if(t.data)return t.r=f[t.data.index];for(var o=t.r=0;o<4;++o)t[o]&&t[o].r>t.r&&(t.r=t[o].r)}function p(){if(u){var t,o=u.length,m;for(f=new Array(o),t=0;t<o;++t)m=u[t],f[m.index]=+n(m,t,u)}}return s.initialize=function(t,o){u=t,C=o,p()},s.iterations=function(t){return arguments.length?(h=+t,s):h},s.strength=function(t){return arguments.length?(r=+t,s):r},s.radius=function(t){return arguments.length?(n=typeof t=="function"?t:W(+t),p(),s):n},s}const ot={class:"brain-canvas relative h-full w-full overflow-hidden"},rt={class:"pointer-events-none absolute inset-0 z-0 h-full w-full"},lt=["x1","y1","x2","y2","stroke","stroke-width"],ct=["onClick"],ut={class:"mb-2 text-lg font-bold"},dt={class:"mb-4 text-sm text-white/70"},ft={class:"grid grid-cols-2 gap-3 text-xs"},vt={class:"glass-panel rounded-lg p-2"},pt={class:"text-lg font-bold text-cyan-400"},mt={class:"glass-panel rounded-lg p-2"},yt={class:"text-lg font-bold text-purple-400"},gt=R({__name:"BrainCanvas",props:{capabilities:{type:Array,required:!0},connections:{type:Array,default:()=>[]}},emits:["nodeClick"],setup(n,{emit:u}){const f=n,C=u,r=L([]),h=L([]),s=L(null),B=L(null),p=L(0),t=L(0),o=S(()=>s.value?Math.min(s.value.x+180,p.value-400):0),m=S(()=>s.value?Math.max(s.value.y-100,100):0),l=()=>{p.value=window.innerWidth,t.value=window.innerHeight-73,r.value=f.capabilities.map(e=>({...e,x:e.x||Math.random()*p.value,y:e.y||Math.random()*t.value,isFocused:!1,fx:null,fy:null}))},_=()=>{f.connections.length>0&&(h.value=f.connections.map(e=>{const i=e.source??e.source_id??null,a=e.target??e.target_id??null;return{source:r.value.find(z=>z.id===Number(i)),target:r.value.find(z=>z.id===Number(a)),isCritical:e.is_critical||!1}}))},b=()=>{B.value=Z(r.value).force("link",q(h.value).id(e=>e.id).distance(150)).force("charge",tt().strength(e=>-300-e.importance*50)).force("center",et(p.value/2,t.value/2)).force("collision",it().radius(e=>60+e.importance*15)).alphaDecay(.01).on("tick",()=>{r.value=[...r.value]})},N=e=>{r.value.forEach(i=>i.isFocused=!1),e.isFocused=!0,s.value=e,B.value.alphaTarget(.3).restart(),e.fx=p.value/2,e.fy=t.value/2,setTimeout(()=>{e.fx=null,e.fy=null,B.value.alphaTarget(0)},2e3),C("nodeClick",e)},F=e=>e.target.required-e.target.level>2?"url(#criticalLink)":"url(#healthyLink)",M=e=>e.isCritical?3:1.5,I=e=>{C("nodeClick",e)};return P(()=>{l(),_(),b()}),X(()=>f.capabilities,()=>{l(),_(),b()},{deep:!0}),(e,i)=>(k(),w("div",ot,[(k(),w("svg",rt,[i[1]||(i[1]=Y('<defs data-v-70597ea6><linearGradient id="healthyLink" x1="0%" y1="0%" x2="100%" y2="0%" data-v-70597ea6><stop offset="0%" style="stop-color:rgba(6, 182, 212, 0.4);stop-opacity:1;" data-v-70597ea6></stop><stop offset="100%" style="stop-color:rgba(139, 92, 246, 0.4);stop-opacity:1;" data-v-70597ea6></stop></linearGradient><linearGradient id="criticalLink" x1="0%" y1="0%" x2="100%" y2="0%" data-v-70597ea6><stop offset="0%" style="stop-color:rgba(239, 68, 68, 0.6);stop-opacity:1;" data-v-70597ea6></stop><stop offset="100%" style="stop-color:rgba(251, 146, 60, 0.6);stop-opacity:1;" data-v-70597ea6></stop></linearGradient></defs>',1)),(k(!0),w(V,null,j(h.value,a=>(k(),w("line",{key:`link-${a.source.id}-${a.target.id}`,x1:a.source.x,y1:a.source.y,x2:a.target.x,y2:a.target.y,stroke:F(a),"stroke-width":M(a),class:G(["transition-all duration-300",{"animate-pulse":a.isCritical}])},null,10,lt))),128))])),(k(!0),w(V,null,j(r.value,a=>(k(),w("div",{key:a.id,class:"absolute z-10 transition-all duration-100",style:D({left:a.x+"px",top:a.y+"px",transform:"translate(-50%, -50%)",zIndex:a.isFocused?50:10}),onClick:z=>N(a)},[T(at,{capability:a,class:G({"scale-125 shadow-2xl":a.isFocused})},null,8,["capability","class"])],12,ct))),128)),T(O,{name:"fade"},{default:J(()=>[s.value?(k(),w("div",{key:0,class:"glass-panel-strong absolute z-50 max-w-sm rounded-2xl p-6 shadow-2xl",style:D({left:o.value+"px",top:m.value+"px"})},[d("h3",ut,A(s.value.name),1),d("p",dt,A(s.value.description),1),d("div",ft,[d("div",vt,[i[2]||(i[2]=d("div",{class:"text-white/50"},"Nivel Actual",-1)),d("div",pt," N"+A(s.value.level),1)]),d("div",mt,[i[3]||(i[3]=d("div",{class:"text-white/50"},"Requerido",-1)),d("div",yt," R"+A(s.value.required),1)])]),d("button",{onClick:i[0]||(i[0]=a=>I(s.value)),class:"mt-4 w-full rounded-lg bg-gradient-to-r from-cyan-500 to-blue-500 py-2 text-sm font-semibold"}," Ver Plan de Desarrollo ")],4)):K("",!0)]),_:1})]))}}),bt=Q(gt,[["__scopeId","data-v-70597ea6"]]);export{bt as default};
