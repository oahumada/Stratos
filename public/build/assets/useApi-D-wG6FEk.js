import{i as d}from"./apiHelper-BLoNXDsG.js";import{k as g,l as m}from"./app-B4Q7DtOZ.js";const h=window.location.origin,c=m.create({baseURL:h,withCredentials:!0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});c.interceptors.request.use(async n=>{document.cookie.includes("XSRF-TOKEN=")||await d().catch(()=>null);const i=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");return i&&(n.headers["X-CSRF-TOKEN"]=i),n});c.interceptors.response.use(n=>n,n=>(n.response?.status===401&&(window.location.href="/login"),Promise.reject(n)));function v(){const n=g(!1),l=g(null),i=async(e,r,t,f)=>{n.value=!0,l.value=null;try{let s=f;e==="get"&&t&&typeof t=="object"&&(s={...f,params:t},t=void 0);let o;return e==="get"?o=await c.get(r,s):o=await c[e](r,t,s),o.data}catch(s){let o="An error occurred";if(s?.response){const a=s.response.data;if(a&&typeof a=="object"&&a.message)o=a.message;else if(a&&typeof a=="string"){const u=a.trim();u.startsWith("<")?o="Server error (returned HTML). Check server logs for details.":o=u.length>200?u.slice(0,200)+"...":u}else s.message&&(o=s.message)}else s.message&&(o=s.message);l.value=o;const p=s instanceof Error?s:new Error(String(s));throw p.friendlyMessage=o,p}finally{n.value=!1}};return{api:c,isLoading:n,error:l,get:(e,r,t)=>{const f={...t||{},params:r};return i("get",e,void 0,f)},post:(e,r,t)=>i("post",e,r,t),put:(e,r,t)=>i("put",e,r,t),delete:(e,r)=>i("delete",e,void 0,r),patch:(e,r,t)=>i("patch",e,r,t)}}export{v as u};
